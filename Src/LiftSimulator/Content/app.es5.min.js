"use strict";(function(){var n=angular.module("lift-simulator",[],function(n){n.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8";var t=function t(n){var r="",f,i,o,h,s,u,e;for(f in n)if(i=n[f],i instanceof Array)for(e=0;e<i.length;++e)s=i[e],o=f+"["+e+"]",u={},u[o]=s,r+=t(u)+"&";else if(i instanceof Object)for(h in i)s=i[h],o=f+"["+h+"]",u={},u[o]=s,r+=t(u)+"&";else i!==undefined&&i!==null&&(r+=encodeURIComponent(f)+"="+encodeURIComponent(i)+"&");return r.length?r.substr(0,r.length-1):r};n.defaults.transformRequest=[function(n){return angular.isObject(n)&&String(n)!=="[object File]"?t(n):n}]});n.controller=n.controller("lift-controller",["$http","$scope",function(n,t){var i,u,r;for(t.tick=0,t.levelCount=10,t.levels=[],t.lifts=[],t.log=[],i=1;i<=t.levelCount;i++){for(u=[],r=1;r<=t.levelCount;r++)u.push(r);t.levels.push({number:i,waitingCount:0,peopleCount:0,targetLevel:1,targetLevels:u})}t.advance=function(){t.tick++;n.get("/api/v1/simulator/ticks/"+t.tick).success(function(n){console.log(n);t.lifts=n.Context.Lifts;_.each(n.Context.Levels,function(n){var i=_.find(t.levels,function(t){return t.number&&t.number===n.Number});i&&(i.waitingCount=n.Waiting)})})};t.reset=function(){n.get("/api/v1/simulator/reset/").success(function(n){console.log(n);t.lifts=n.Context.Lifts;t.tick=0;_.each(n.Context.Levels,function(n){var i=_.find(t.levels,function(t){return t.number&&t.number===n.Number});i&&(i.waitingCount=n.Waiting)})})};t.getLiftCssClass=function(n,i){var r=_.find(t.lifts,function(t){return t.Id&&t.Id===n});return r&&r.CurrentFloor===i?{active:!0,up:r.Direction===0,down:r.Direction===-1,stopped:r.Direction===null}:{}};t.callLift=function(i,r,u){var f,e;i<=0||r<1||u<1||(f=_.find(t.levels,function(n){return n.number===r}),f)&&(e=parseInt(i,10),e!==NaN&&n.post("api/v1/simulator/request-lift",{tick:t.tick,peopleCount:i,sourceFloorNumber:r,targetFloorNumber:u}).success(function(n){f.peopleCount=0;f.waitingCount+=e;console.log(n)}))};t.reset()}]);n.filter("reverse",function(){return function(n){return n.slice().reverse()}})})();